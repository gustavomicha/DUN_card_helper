const craftingData = [{'recurso_original': 'assets/images/ESP/items/recursos/babosa_de_dragon_(27).jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/centinela.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_del_oraculo.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/babosa_de_dragon_(27).jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/escarabajo_martillo_(29).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_brebaje_del_gypcian.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/bayas_de_lynn.jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/cardo_azul_de_anam.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_agua_de_lynn.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/cardo_azul_de_anam.jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/bayas_de_lynn.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_agua_de_lynn.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/casa_de_hadas.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/runa_antimagia.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/centinela.jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/babosa_de_dragon_(27).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_del_oraculo.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/coraza_roja_(4).jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/corazon_de_huargo.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_elixir_de_vida_(41).jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/corazon_de_huargo.jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/coraza_roja_(4).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_elixir_de_vida_(41).jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/duermevela.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_teleportacion.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/hacha.jpg',
    'resultado': 'assets/misc/craft/hacha_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/maza.jpg',
    'resultado': 'assets/misc/craft/maza_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/duermevela.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_teleportacion.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/escarabajo_martillo_(29).jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/babosa_de_dragon_(27).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_brebaje_del_gypcian.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/fantasma_rosa.jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_sangre_de_sapo.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/maza.jpg',
    'resultado': 'assets/misc/craft/maza_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/cristal_rojo_(19).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/hacha.jpg',
    'resultado': 'assets/misc/craft/hacha_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/plata_estelar.jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/espada.jpg',
    'resultado': 'assets/misc/craft/espada_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/casa_de_hadas.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/runa_antimagia.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/escudo.jpg',
    'resultado': 'assets/misc/craft/escudo_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/hongo_soldado_(12).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/lengua_de_dragon.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/runas_explosivas.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/lengua_de_dragon.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hongo_soldado_(12).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/runas_explosivas.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/flechas.jpg',
    'resultado': 'assets/misc/craft/flecha_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/planta_camaleon.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/rama_maligna.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/arco.jpg',
    'resultado': 'assets/misc/craft/arco_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/lanza.jpg',
    'resultado': 'assets/misc/craft/lanza_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/arco.jpg',
    'resultado': 'assets/misc/craft/arco_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/escudo.jpg',
    'resultado': 'assets/misc/craft/escudo_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/sueño_azul.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/oscuridad_embotellada.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/planta_camaleon.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/plata_estelar.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/frasco_de_luz_solar.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/planta_camaleon.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/rama_maligna.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/plata_estelar.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/planta_camaleon.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/frasco_de_luz_solar.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/plata_estelar.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/hierro_blanco_(21).jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/espada.jpg',
    'resultado': 'assets/misc/craft/espada_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'lugar': 'assets/misc/craft/alquimista.png',
    'recurso': 'assets/images/ESP/items/recursos/fantasma_rosa.jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/pocion_de_sangre_de_sapo.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/lanza.jpg',
    'resultado': 'assets/misc/craft/lanza_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/punta_de_obsidiana_(16).jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/madera_de_nor.jpg',
    'oro': 10,
    'extra': 'assets/misc/craft/flechas.jpg',
    'resultado': 'assets/misc/craft/flecha_magico.jpg'},
   {'recurso_original': 'assets/images/ESP/items/recursos/sueño_azul.jpg',
    'lugar': 'assets/misc/craft/esc_hechiceria.png',
    'recurso': 'assets/images/ESP/items/recursos/piedra_de_jade_nocturno_(22).jpg',
    'oro': 1,
    'extra': '-',
    'resultado': 'assets/images/ESP/items/objetos_especiales_exp/oscuridad_embotellada.jpg'}
]
    ;


function getImagePath(name) {
    return `../../${name}`;
}

// Function to populate the select dropdown with available resources
function populateResourceDropdown() {
    const selectElement = document.getElementById('recursos-select');
    
    // Get unique "recurso_original" from craftingData and populate dropdown
    const uniqueResources = [...new Set(craftingData.map(row => row.recurso_original))];
    
    uniqueResources.forEach(resource => {
        const optionElement = document.createElement('option');
        optionElement.value = resource;
        optionElement.textContent = formatResourceName(resource);  // Format resource name
        selectElement.appendChild(optionElement);
    });
}

// Function to format the resource name
function formatResourceName(resource) {
    // Remove directory, parentheses with numbers, underscores, and capitalize first letters
    const fileName = resource.split('/').pop(); // Get the filename only
    const cleanedFileName = fileName.replace(/\(\d+\)/g, '')  // Remove numbers in parentheses
                                    .replace(/_/g, ' ')        // Replace underscores with spaces
                                    .replace(/\b\w/g, char => char.toUpperCase()); // Capitalize first letter of each word
    return cleanedFileName.replace('.Jpg', ''); // Remove the file extension
}


// Utility function to create an element for oro with the number and image
// Utility function to create an element for oro with the number and image
function createOroElement(oro) {
    const oroContainer = document.createElement('div');
    oroContainer.style.display = 'flex';  // Display oro number and image side by side
    oroContainer.style.alignItems = 'center'; // Center vertically

    // Create the oro number with the oro-number class
    const oroText = document.createElement('span');
    oroText.textContent = oro;
    oroText.classList.add('oro-number');  // Add class for oro number styling
    oroContainer.appendChild(oroText);

    // Console log to ensure oro-number class is applied
    console.log('Oro Number Element:', oroText);

    // Create the oro image
    const oroImg = createImageElement('assets/misc/craft/oro.png', 'misc-icon-oro'); // Smaller icon for oro
    oroContainer.appendChild(oroImg);

    return oroContainer;
}



// Function that handles resource selection change
function onResourceChange() {
    const selectElement = document.getElementById('recursos-select');
    const selectedResource = selectElement.value;  // Get selected resource
    
    // Filter crafting data to match the selected resource
    const matchingRows = craftingData.filter(row => row.recurso_original === selectedResource);

    // Clear any previous results
    const outputContainer = document.getElementById('crafting-output');
    outputContainer.innerHTML = '';

    // Generate a row of images for each matching result
    matchingRows.forEach(row => {
        // Create a new row to hold images
        const imageRow = document.createElement('div');

        // Add the images based on the row data, with lugar at the first position
        const images = [
            createImageElement(row.lugar, 'misc-icon'), // Smaller icon for place, now at the first position
            createImageElement(row.recurso_original),
            createImageElement(row.recurso),
            createOroElement(row.oro), // Oro number + oro image
            row.extra !== '-' ? createImageElement(row.extra, 'resource-image') : null,  // Only show extra if it's not '-'
            createImageElement(row.resultado)
        ];

        // Append images with the ":" after "lugar", and "+" or "=" symbols in a structured manner
        images.forEach((img, index) => {
            if (img) {
                imageRow.appendChild(img);
        
                // Add ":" after the first (lugar) image
                if (index === 0) {
                    const colonSign = document.createElement('span');
                    colonSign.textContent = ' : ';
                    colonSign.className = 'symbol'; // Apply the styling to the symbol
                    imageRow.appendChild(colonSign);
                }
                // Handle the "+" symbol for all images except the last two
                else if (index < images.length - 2) {
                    if (img === images[3] && row.extra === '-') {
                        // Skip adding "+" after the 'extra' if it is a placeholder '-'
                        const equalsSign = document.createElement('span');
                        equalsSign.textContent = ' = ';
                        equalsSign.className = 'symbol'; // Apply the styling to the symbol
                        imageRow.appendChild(equalsSign);
                    } else {
                        const plusSign = document.createElement('span');
                        plusSign.textContent = ' + ';
                        plusSign.className = 'symbol'; // Apply the styling to the symbol
                        imageRow.appendChild(plusSign);
                    }
                }
        
                // Add "=" symbol right before the last image
                if (index === images.length - 2) {
                    const equalsSign = document.createElement('span');
                    equalsSign.textContent = ' = ';
                    equalsSign.className = 'symbol'; // Apply the styling to the symbol
                    imageRow.appendChild(equalsSign);
                }
            }
        });

        // Add the row to the output container
        outputContainer.appendChild(imageRow);
    });
}

// Utility function to create an image element
function createImageElement(name, className = 'resource-image') {
    const img = document.createElement('img');
    img.src = getImagePath(name);
    img.alt = name;
    img.className = className;  // Add a class name for styling
    return img;
}


// Run on page load
document.addEventListener('DOMContentLoaded', function () {
    populateResourceDropdown();  // Populate dropdown on load
});


function goToMainMenu() {
    window.parent.location.href = "../../index.html";
}